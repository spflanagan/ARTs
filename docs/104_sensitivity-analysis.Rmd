---
title: "Sensitivity analysis with ARTs Analysis"
author: "Sarah P. Flanagan"
date:  "`r format(Sys.time(), '%d %B, %Y')`"
output:
  pdf_document:
    toc: true
    dev: png
  html_document: 
    toc: true  
header-includes: \usepackage{float}
always_allow_html: yes
editor_options: 
  chunk_output_type: console
---

<style>
p.caption {
  font-size: 0.85em;
  background-color: #f5f5f5
}
</style>

The purpose of this model is to understand how genetic architectures of alternative reproductive tactics impact their maintenance in populations. I'm using an individual-based simulation model with different selection scenarios, types of alternative tactics, and genetic architectures (genome-wide additive genetic variance, supergenes, expression networks).

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE,out.extra='',fig.pos="H",dpi=200)
knitr::opts_knit$set(root.dir='../results/') #change
```
```{r opts, echo = FALSE}
library(knitr)
knitr::opts_chunk$set(
  fig.path = "figs/"
)
```
```{r, echo=FALSE}
library(RColorBrewer)
library(scales)
source("../R/002_freq_functions.R")
cols<-c(courter="#33a02c",parent="#1f78b4",cpref="#b2df8a",ppref="#a6cee3")
cols2<-c(CP='#a1dab4',NCP='#41b6c4',CNP='#2c7fb8',NCNP='#253494')
```


# Polygyny

I want some way of summarizing these data...Could do x-axis with the genetic architectures...and/or polygyny? First need to get all of the outcomes.

## Courter

```{r}
cup<-plot.courter.reps(pattern="^courter_unlinked_polygyny_[1-5]_summary.txt",cols,make.plot=TRUE)
clp<-plot.courter.reps(pattern="^courter_linked_polygyny_[1-5]_summary.txt",cols,make.plot=TRUE)
csp<-plot.courter.reps(pattern="^courter_supergene_polygyny_[1-5]_summary.txt",cols,make.plot=TRUE)
```


## Parent

```{r}
pup<-plot.parent.reps(pattern="^parent_unlinked_polygyny_[1-5]_summary.txt",cols,make.plot=TRUE)
plp<-plot.parent.reps(pattern="^parent_linked_polygyny_[1-5]_summary.txt",cols,make.plot=TRUE)
psp<-plot.parent.reps(pattern="^parent_supergene_polygyny_[1-5]_summary.txt",cols,make.plot=TRUE)
```

## Courter-Parent

```{r}
up<-plot.pc.reps("^parent-courter_unlinked_polygyny_[1-5]_summary.txt",cols,make.plot=TRUE)
lapply(up,function(rep){
  freqs<-rep[nrow(rep),grep("Freq",colnames(rep))]
})
lp<-plot.pc.reps("^parent-courter_linked_polygyny_[1-5]_summary.txt",cols,make.plot=FALSE)
lapply(lp,function(rep){
  freqs<-rep[nrow(rep),grep("Freq",colnames(rep))]
})
sp<-plot.pc.reps("^parent-courter_supergene_polygyny_[1-5]_summary.txt",cols,make.plot=FALSE)
lapply(sp,function(rep){
  freqs<-rep[nrow(rep),grep("Freq",colnames(rep))]
})
```

